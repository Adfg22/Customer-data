<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>بوابة مساهمين الرهوان — Dashboard</title>

<!-- استخدمت خطوط النظام لتبسيط التحميل، لكن يمكنك استبدالها بـ Google Font لاحقاً -->
<style>
  :root{
    --bg-1: #f5f9ff;        /* very soft blue */
    --bg-2: #ffffff;        /* white card */
    --accent-1: #3b82f6;    /* soft brand blue */
    --accent-2: #60a5fa;    /* lighter blue */
    --muted: #6b7280;       /* muted gray */
    --silver: #e6eefc;      /* silver/soft */
    --glass: rgba(255,255,255,0.6);
    --shadow: 0 8px 30px rgba(20,40,80,0.06);
    --radius-lg: 18px;
    --radius-md: 12px;
    --radius-sm: 8px;
    --transition: 300ms cubic-bezier(.2,.9,.2,1);
  }

  /* ---- Base ---- */
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    min-height:100vh;
    background:
      radial-gradient(1200px 400px at 10% 10%, rgba(96,165,250,0.08), transparent 12%),
      radial-gradient(1000px 350px at 90% 90%, rgba(59,130,246,0.06), transparent 10%),
      var(--bg-1);
    color:#0f172a;
    font-family: Inter, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding:32px;
    display:flex;
    justify-content:center;
  }

  /* ---- Container ---- */
  .wrap{
    width:100%;
    max-width:1200px;
  }

  /* ---- Header ---- */
  header.app-header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
    margin-bottom:20px;
  }

  .brand{
    display:flex;
    align-items:center;
    gap:14px;
  }
  .brand .logo {
    width:56px;height:56px;border-radius:12px;
    background: linear-gradient(135deg,var(--accent-1),var(--accent-2));
    display:flex;align-items:center;justify-content:center;
    box-shadow: 0 8px 30px rgba(59,130,246,0.18);
    color:#fff;font-weight:700;font-size:18px;
  }
  .brand h1{
    margin:0;font-size:18px;font-weight:700;color:#0b1220;
    letter-spacing:0.2px;
  }
  .brand p{margin:0;font-size:12px;color:var(--muted)}

  /* ---- Header controls ---- */
  .header-actions{
    display:flex;align-items:center;gap:12px;
  }
  .search {
    display:flex;align-items:center;gap:10px;
    background:linear-gradient(180deg,var(--silver),#fff);
    border-radius:999px;padding:8px 12px;border:1px solid rgba(15,23,42,0.04);
    min-width:280px;box-shadow:var(--shadow);
  }
  .search input{
    border:0;background:transparent;outline:none;font-size:14px;color:#071133;
    width:100%;
  }
  .toggle-theme{
    background:transparent;border:1px solid rgba(15,23,42,0.06);padding:8px;border-radius:10px;
    cursor:pointer;font-size:14px;color:var(--muted);
    transition:all var(--transition);
  }
  .toggle-theme:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(59,130,246,0.06)}

  /* ---- Main grid ---- */
  main.grid{
    display:grid;
    grid-template-columns: 360px 1fr;
    gap:20px;
    align-items:start;
  }

  /* ---- Left panel (controls) ---- */
  .panel{
    background:var(--bg-2);
    border-radius:var(--radius-lg);
    padding:22px;
    box-shadow:var(--shadow);
    border:1px solid rgba(15,23,42,0.03);
  }
  .panel h2{margin:0 0 10px;font-size:16px;color:#071133}
  .panel p.lead{margin:0 0 18px;color:var(--muted);font-size:13px}

  .input-wrap{margin-bottom:12px}
  .input-wrap input{
    width:100%;padding:12px 14px;border-radius:10px;border:1px solid rgba(15,23,42,0.06);
    background:linear-gradient(180deg,#fcfeff,var(--glass));font-size:14px;color:#071133;
    transition:box-shadow var(--transition),border-color var(--transition);
  }
  .input-wrap input:focus{box-shadow:0 8px 22px rgba(59,130,246,0.08);border-color:var(--accent-1);outline:none}

  .primary-btn{
    width:100%;padding:12px;border-radius:12px;border:0;background:linear-gradient(90deg,var(--accent-1),var(--accent-2));
    color:#fff;font-weight:700;font-size:14px;cursor:pointer;box-shadow:0 8px 24px rgba(96,165,250,0.18);
    transition:transform var(--transition),box-shadow var(--transition);
  }
  .primary-btn:hover{transform:translateY(-3px);box-shadow:0 16px 40px rgba(96,165,250,0.22)}

  .small-note{margin-top:10px;font-size:12px;color:var(--muted)}

  /* ---- Right panel (dashboard) ---- */
  .dashboard{
    display:flex;flex-direction:column;gap:18px;
  }

  /* member card */
  .member-card{
    display:flex;align-items:flex-start;gap:18px;
    background:linear-gradient(180deg,#ffffff, #fbfdff);
    border-radius:var(--radius-lg);
    padding:18px;border:1px solid rgba(15,23,42,0.04);
    box-shadow: 0 14px 40px rgba(12,32,80,0.06);
  }
  .member-avatar{
    width:84px;height:84px;border-radius:14px;background:linear-gradient(135deg,var(--accent-2),var(--accent-1));
    display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:20px;
    box-shadow:0 10px 30px rgba(59,130,246,0.12);
    flex-shrink:0;
  }
  .member-info h3{margin:0;font-size:18px;color:#071133}
  .member-info .id{margin-top:6px;font-size:13px;color:var(--muted)}
  .member-badges{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}

  .member-stats{
    margin-top:12px;display:flex;gap:12px;flex-wrap:wrap;
  }
  .stat{
    background:linear-gradient(180deg,#f8fbff,#ffffff);
    border-radius:12px;padding:12px;min-width:120px;text-align:center;border:1px solid rgba(15,23,42,0.03);
    box-shadow:0 8px 24px rgba(12,32,80,0.04);
  }
  .stat b{display:block;color:#0b1220;font-size:16px}
  .stat span{display:block;color:var(--muted);font-size:12px;margin-top:6px}

  /* action row */
  .action-row{display:flex;gap:12px;margin-top:14px;flex-wrap:wrap}
  .ghost-btn{
    border-radius:12px;padding:10px 12px;border:1px solid rgba(15,23,42,0.06);background:transparent;color:#071133;cursor:pointer;
    transition:all var(--transition);
  }
  .ghost-btn:hover{transform:translateY(-3px);box-shadow:0 12px 30px rgba(59,130,246,0.06)}

  /* features grid — modern card style */
  .features-section{
    background:linear-gradient(180deg,#ffffff,#fbfdff);
    padding:18px;border-radius:var(--radius-lg);box-shadow:var(--shadow);border:1px solid rgba(15,23,42,0.03);
  }
  .features-head{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
  .features-head h4{margin:0;font-size:15px}
  .features-grid{
    display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px;
  }

  .feature-card{
    display:flex;gap:12px;align-items:center;padding:14px;border-radius:12px;background:linear-gradient(180deg,#fff,#fbfdff);
    border:1px solid rgba(15,23,42,0.03);box-shadow:0 8px 20px rgba(12,32,80,0.04);
    transition:transform var(--transition),box-shadow var(--transition);
    opacity:0;transform:translateY(18px); /* animated in via JS delays below */
  }
  .feature-card:hover{transform:translateY(-6px) scale(1.01);box-shadow:0 20px 40px rgba(59,130,246,0.07)}
  .feature-icon{
    min-width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,var(--accent-2),var(--accent-1));
    display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:18px;box-shadow:0 8px 24px rgba(59,130,246,0.12);
  }
  .feature-body h5{margin:0;font-size:14px;color:#071133}
  .feature-body p{margin:6px 0 0;color:var(--muted);font-size:12px}

  /* catalog (redeem) */
  .redeem-panel{background:linear-gradient(180deg,#ffffff,#fbfdff);padding:18px;border-radius:14px;border:1px solid rgba(15,23,42,0.03);box-shadow:var(--shadow)}
  .catalog-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
  .catalog-item{
    background:linear-gradient(180deg,#fbfdff,#fff);padding:14px;border-radius:12px;border:1px solid rgba(15,23,42,0.03);
    display:flex;flex-direction:column;gap:10px;box-shadow:0 8px 20px rgba(12,32,80,0.04);
    transition:transform var(--transition),box-shadow var(--transition);
    opacity:0;transform:translateY(16px);
  }
  .catalog-item h5{margin:0;font-size:14px;color:#071133}
  .catalog-item p{margin:0;font-size:13px;color:var(--muted)}
  .catalog-item .cost{font-weight:700;color:#0b1220}
  .catalog-item button{
    margin-top:8px;padding:10px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--accent-1),var(--accent-2));
    color:#fff;font-weight:700;cursor:pointer;
  }
  .catalog-item:hover{transform:translateY(-6px);box-shadow:0 18px 44px rgba(59,130,246,0.08)}

  /* small responsive */
  @media (max-width:980px){
    main.grid{grid-template-columns:1fr; padding-bottom:40px}
    .search{min-width:160px}
  }

  /* subtle helper for progressive reveal via inline style animationDelay from JS */
  .reveal-animate{animation:fadeUpEase 600ms cubic-bezier(.2,.9,.2,1) forwards}
  @keyframes fadeUpEase{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>
  <div class="wrap">

    <!-- HEADER -->
    <header class="app-header">
      <div class="brand">
        <div class="logo">R</div>
        <div>
          <h1>بوابة مساهمين الرهوان</h1>
          <p class="muted">لوحة المساهمين — تجربة VIP حديثة</p>
        </div>
      </div>

      <div class="header-actions">
        <div class="search" title="بحث سريع">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="opacity:.8">
            <path d="M21 21l-4.35-4.35" stroke="#0b1220" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="11" cy="11" r="6" stroke="#0b1220" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <input id="headerSearch" placeholder="ابحث عن اسم أو ID..." aria-label="search"/>
        </div>

        <button class="toggle-theme" title="الوضع">وضع حديث</button>
      </div>
    </header>

    <!-- MAIN GRID -->
    <main class="grid">

      <!-- LEFT: Controls -->
      <aside class="panel" aria-labelledby="member-search">
        <h2 id="member-search">الوصول السريع للمساهم</h2>
        <p class="lead">ادخل الـ ID الخاص بالمساهم لعرض بياناته وإدارة نقاطه.</p>

        <div class="input-wrap">
          <input id="memberIdInput" placeholder="مثال: VIP2025" />
        </div>
        <button class="primary-btn" onclick="fetchMember()">عرض بياناتي</button>

        <p class="small-note">لا نغير أي من وظائف النظام — تصميم العرض فقط. يمكنك استخدام حقل البحث العلوي كبديل للـ ID.</p>

        <div style="height:12px"></div>

        <div style="display:flex;gap:10px">
          <button class="ghost-btn" onclick="openRedeem()">فتح نافذة الاستبدال</button>
          <button class="ghost-btn" onclick="closeRedeem()">إغلاق نافذة</button>
        </div>
      </aside>

      <!-- RIGHT: Dashboard -->
      <section class="dashboard">

        <!-- Member Card (يتحدث ديناميكياً) -->
        <div id="memberPanel" class="member-card" style="display:none">
          <div class="member-avatar" id="memberAvatar">M</div>
          <div style="flex:1">
            <div class="member-info">
              <h3 id="memberName">اسم المساهم</h3>
              <div class="id" id="memberIdLabel">ID: ---</div>
              <div class="member-badges" id="memberBadges"></div>

              <div class="member-stats" style="margin-top:12px">
                <div class="stat">
                  <b id="endDate">----</b>
                  <span>تاريخ الانتهاء</span>
                </div>
                <div class="stat">
                  <b id="daysLeft">--</b>
                  <span>الأيام المتبقية</span>
                </div>
                <div class="stat">
                  <b id="points">0</b>
                  <span>رصيد النقاط</span>
                </div>
              </div>

              <div class="action-row">
                <button class="primary-btn" style="width:auto;padding:10px 14px" onclick="openRedeem()">🎯 استبدل النقاط</button>
                <button class="ghost-btn" onclick="alert('هذه عملية تجريبية')">✉️ تواصل مع المساهم</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Features -->
        <div class="features-section">
          <div class="features-head">
            <h4>⭐ ميزات المساهم</h4>
            <div class="muted" style="font-size:13px">تصميم عصري — مرتب حسب الأهمية</div>
          </div>

          <div id="featureList" class="features-grid">
            <!-- تم إنشاء الكروت ديناميكياً بواسطة JS مع تأخير للـ animation -->
          </div>
        </div>

        <!-- Redeem / Catalog -->
        <div id="redeemPanel" class="redeem-panel" style="display:none">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <h4 style="margin:0">🎯 كتالوج الاستبدال</h4>
            <div class="muted" style="font-size:13px">استبدل نقاطك مقابل الجوائز</div>
          </div>

          <div id="catalog" class="catalog-grid">
            <!-- عناصر الكتالوج تبنى ديناميكياً -->
          </div>
        </div>

        <!-- Gifts -->
        <div class="panel" style="padding:16px">
          <h4 style="margin:0 0 8px">🎁 الهدايا والمكافآت</h4>
          <ul id="giftList" style="margin-top:12px;color:var(--muted)"></ul>
        </div>

      </section>
    </main>
  </div>

  <!-- ===== JavaScript (لا تغييرات في الوظائف الأساسية) ===== -->
  <script>
    /* === DATA & CATALOG (كما في النسخة السابقة) === */
    const CATALOG = [
      { id: 'P_SMALL', name: 'عطر صغير 5 مل', cost: 50, desc: 'عطر صغير يمكن استبداله بالنقاط' },
      { id: 'DISCOUNT_5', name: 'خصم 5% على الطلب', cost: 40, desc: 'خصم إضافي على طلبك التالي' },
      { id: 'GIFT_SET', name: 'باقة هدية (3×5مل)', cost: 120, desc: 'باقة صغيرة ترحيبية' },
      { id: 'FREE_50ML', name: 'عطر أصلي 50 مل (مناسبة)', cost: 400, desc: 'عطر 50 مل لمن تنطبق عليه المناسبة' }
    ];

    const FEATURES = [
      "🎁 خصم 15% على كل طلب لمدة سنة واحدة",
      "🌸 عطر اصلي 50 مل في كل مناسبة (عيد الفطر _ عيد الأضحى _ عيد ميلادك)",
      "💳 كرت عضوية خاص بالمساهم",
      "⚡ أولوية في إنهاء الطلبات",
      "🔄 إمكانية التجديد مقابل مبلغ بسيط كل سنة",
      "🎀 مكافآت مع البكج عند كل طلب",
      "🛍️ هدية ترحيبية عند الاشتراك (3 عبوات عطر 5 مل)",
      "🌟 دعوات خاصة لتجربة عطور VIP قبل نشرها",
      "💎 تجميع نقاط يمكن استبدالها بعطر صغير أو خصم إضافي",
      "📢 إشعار مبكر بالعروض قبل يوم أو يومين"
    ];

    /* === Helpers (احتفظت بنفس المنطق) === */
    function formatDateISO(d){
      const dt = new Date(d);
      if (isNaN(dt)) return "-";
      return `${dt.getFullYear()}-${String(dt.getMonth()+1).padStart(2,'0')}-${String(dt.getDate()).padStart(2,'0')}`;
    }
    function daysBetween(from,to){
      const f=new Date(from), t=new Date(to);
      return Math.ceil((t-f)/(1000*60*60*24));
    }
    function calcDaysLeft(endDate){
      const today=new Date(); today.setHours(0,0,0,0);
      const end=new Date(endDate); end.setHours(0,0,0,0);
      return daysBetween(today,end);
    }

    /* === Current member holder === */
    let CURRENT_MEMBER = null;

    /* === Fetch member from contributors.json (كما كان) === */
    function fetchMember(){
      const id = document.getElementById("memberIdInput").value.trim();
      if(!id){ alert("أدخل ID"); return; }

      fetch("contributors.json")
        .then(res => res.json())
        .then(DB => {
          const member = DB.members[id];
          if(!member){ alert("لا توجد بيانات لهذا الـID"); return; }
          CURRENT_MEMBER = member;
          showMember(member);
        })
        .catch(err => alert("خطأ في تحميل البيانات: " + err));
    }

    /* === Show member (وظائف كما كانت، فقط عناصر DOM مُعاد تصميمها) === */
    function showMember(member){
      document.getElementById("memberPanel").style.display = "flex";
      document.getElementById("memberName").textContent = member.name;
      document.getElementById("memberIdLabel").textContent = "ID: " + member.id;
      document.getElementById("endDate").textContent = formatDateISO(member.endDate);

      const days = calcDaysLeft(member.endDate);
      document.getElementById("daysLeft").textContent = days>0 ? days + " يوم" : "انتهت الصلاحية";
      document.getElementById("points").textContent = member.points || 0;

      // avatar initial
      const avatar = document.getElementById("memberAvatar");
      avatar.textContent = (member.name ? member.name.charAt(0) : 'M').toUpperCase();

      // badges
      const badgeWrap = document.getElementById("memberBadges");
      badgeWrap.innerHTML = "";
      if(member.isVIP) badgeWrap.appendChild(createBadge("VIP"));
      if(member.invites && member.invites>0) badgeWrap.appendChild(createBadge("دعوات VIP: " + member.invites));

      // gifts
      const giftList = document.getElementById("giftList");
      giftList.innerHTML = "";
      if(member.gifts && member.gifts.length>0){
        member.gifts.forEach(g=>{
          const li = document.createElement("li");
          li.textContent = g;
          li.style.marginBottom = "6px";
          giftList.appendChild(li);
        });
      } else {
        const li = document.createElement("li");
        li.textContent = "لا توجد هدايا";
        giftList.appendChild(li);
      }

      // features (with animated reveal)
      const featureList = document.getElementById("featureList");
      featureList.innerHTML = "";
      FEATURES.forEach((f, i) => {
        const card = document.createElement("div");
        card.className = "feature-card reveal-animate";
        card.style.animationDelay = (i * 80) + "ms";

        const icon = document.createElement("div");
        icon.className = "feature-icon";
        icon.textContent = f.split(" ")[0];

        const body = document.createElement("div");
        body.className = "feature-body";
        const title = document.createElement("h5");
        title.textContent = f.substring(f.indexOf(" ")+1);
        const desc = document.createElement("p");
        desc.textContent = ""; // يمكنك إضافة وصف لكل ميزة هنا لو رغبت
        body.appendChild(title);
        body.appendChild(desc);

        card.appendChild(icon);
        card.appendChild(body);
        featureList.appendChild(card);
      });

      // render catalog for that member
      renderCatalog(member);
      // scroll to member panel (nice UX)
      setTimeout(()=>{ document.getElementById("memberPanel").scrollIntoView({behavior:"smooth", block:"center"}); }, 200);
    }

    function createBadge(text){
      const s = document.createElement("span");
      s.style.padding = "6px 10px";
      s.style.background = "linear-gradient(90deg,#eef6ff,#f3f9ff)";
      s.style.borderRadius = "10px";
      s.style.fontWeight = "700";
      s.style.color = "#0b1220";
      s.style.fontSize = "12px";
      s.textContent = text;
      return s;
    }

    /* === Redeem / Catalog rendering & actions (وظائف كما كانت) === */
    function openRedeem(){
      if(!CURRENT_MEMBER){ alert("ادخل ID أولاً"); return; }
      const panel = document.getElementById("redeemPanel");
      panel.style.display = "block";
      panel.scrollIntoView({behavior:"smooth", block:"center"});
    }
    function closeRedeem(){ document.getElementById("redeemPanel").style.display = "none"; }

    function renderCatalog(member){
      const c = document.getElementById("catalog");
      c.innerHTML = "";
      CATALOG.forEach((item, idx) => {
        const box = document.createElement("div");
        box.className = "catalog-item reveal-animate";
        box.style.animationDelay = (idx * 90) + "ms";

        const h = document.createElement("h5");
        h.textContent = item.name;

        const p = document.createElement("p");
        p.textContent = item.desc;

        const cost = document.createElement("div");
        cost.className = "cost";
        cost.textContent = item.cost + " نقطة";

        const btn = document.createElement("button");
        btn.textContent = "استبدل الآن";
        btn.onclick = () => redeemItem(member, item);

        box.appendChild(h);
        box.appendChild(p);
        box.appendChild(cost);
        box.appendChild(btn);
        c.appendChild(box);
      });
    }

    function redeemItem(member, item){
      if((member.points || 0) < item.cost){ alert("رصيدك غير كافٍ للاستبدال!"); return; }
      member.points -= item.cost;
      document.getElementById("points").textContent = member.points;
      alert("✅ تم استبدال " + item.name + " بنجاح!");
    }

    /* === Optional: hook header search to try fetch by id or name (non-invasive) === */
    document.getElementById("headerSearch").addEventListener("keydown", function(e){
      if(e.key === "Enter"){
        const q = this.value.trim();
        if(!q) return;
        // حاول معالجة كـ ID أولاً، وإلا ضع القيمة حقل الـ ID ثم نفّذ fetch
        document.getElementById("memberIdInput").value = q;
        fetchMember();
      }
    });

    /* === عند التحميل: إن كنت تريد عرض عناصر افتراضية يمكنك استدعاء showMember(...) هنا === */
    // مثال تجريبي (أزل التعليق إن أردت)
    // document.addEventListener("DOMContentLoaded", ()=>{ /* يمكن عمل fetch افتراضي هنا */ });

  </script>
</body>
</html>
